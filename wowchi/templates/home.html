<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>wowchi</title>
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
        {% assets "css" %}<link rel="stylesheet" href="{{ ASSET_URL }}" type="text/css" />{% endassets %}
    </head>
    <body data-bind="attr: {class: character_class_faction}">
        <header>
            <div>
                <select data-bind="options: locales,
                                   optionsText: 'country',
                                   value: locale,
                                   optionsCaption: 'Region...'" class="selectpicker"></select>
            </div>

            <div>
                <select data-bind="options: realms,
                                   optionsText: 'name',
                                   value: realm,
                                   optionsCaption: 'Realm...'" class="selectpicker"></select>
            </div>

            <div>
                <input type="text" placeholder="Character name" data-bind="value: character_name" />
            </div>

            <div>
                <button data-bind="click: find, disable: working">
                    <span data-bind="ifnot: working">Find</span>
                    <span data-bind="if: working"><i class="fa fa-spinner fa-spin fa-lg"></i></span>
                </button>
            </div>
        </header>

        <main>
            <div id="intro" data-bind="visible: completed().length === 0">
                <h2>Welcome to WoWchi</h2>
                <p>Here you can track and plan your WoW achievements. What do you want to do next?</p>
                <p>Get started by choosing your region and realm from the drop downs above. Then type in your character name and click find.</p>
            </div>
            <ul id="available" data-bind="visible: completed().length !== 0, foreach: available, style: { right: exploring() ? '340px' : '-5px' }">
                <h2><a href="#" data-bind="text: $data.name, click: $root.open_category"></a></h2>
                <div data-bind="if: $root.category_is_opened($data)">
                    <ul class="icons" data-bind="foreach: $data.achievements">
                        <li>
                            <a href="#" data-bind="click: $root.explore_achi">
                                <img data-bind="attr: {src: $root.icon($data.icon), title: $data.description},
                                                css: {complete: $root.achi_is_completed($data),
                                                      exploring: $root.is_exploring($data)}" />
                            </a>
                        </li>
                    </ul>
                    <ul class="categories" data-bind="foreach: $data.categories">
                        <li>
                            <h3><a href="#" data-bind="text: $data.name, click: $root.open_category"></a></h3>
                            <div data-bind="if: $root.opened.indexOf($data.name) !== -1">
                                <ul class="icons" data-bind="foreach: $data.achievements">
                                    <li>
                                        <a href="#" data-bind="click: $root.explore_achi">
                                            <img data-bind="attr: {src: $root.icon($data.icon), title: $data.description},
                                                            css: {complete: $root.achi_is_completed($data),
                                                                  exploring: $root.is_exploring($data)}" />
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </ul>
            <div id="exploring" data-bind="if: exploring, style: { right: exploring() ? '0px' : '-400px' }">
                <a class="wowhead" 
                   target="_blank" 
                   data-bind="attr: {href: $root.wowhead_link}">
                        <img src="http://cdn.zamimg.com/zul/1.0.x/icons/sites/wowhead.png" />
                </a>
                <a class="addtoqueue"
                   href="#"
                   data-bind="click: $root.add_to_queue,
                              visible: $root.can_add_to_queue()">
                        Add to Queue
                </a>
                <a class="close" href="#" data-bind="click: $root.close_explore"><i class="fa fa-times fa-fw fa-lg"></i></a>
                <img class="icon" data-bind="attr: {src: $root.icon(exploring().icon, 56), title: exploring().description}" />
                <div class="title" data-bind="text: exploring().title"></div>
                <div class="description" data-bind="text: exploring().description"></div>
                <div data-bind="if: exploring().reward">
                    <div class="rewards" data-bind="text: exploring().reward"></div>
                </div>
                <div data-bind="if: exploring().criteria.length">
                    <div class="criteria">
                        <ul data-bind="foreach: exploring().criteria">
                            <li class="criterion" data-bind="css: {'met': $root.criterion_met($data)}">
                                <span data-bind="text: $data.description"></span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div id="queue" data-bind="visible: completed().length !== 0">
                <h2 data-bind="visible: queue().length === 0">Nothing in the queue :(</h2>
                <ul data-bind="foreach: queue">
                    <li>
                        <a href="#" data-bind="click: $root.explore_achi">
                            <img data-bind="attr: {src: $root.icon($data.icon, 56), title: $data.description}" />
                        </a>
                        <a class="remove" href="#" data-bind="click: $root.remove_from_queue">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-times fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                </ul>
            </div>
            <ul id="messages"></ul>
        </main>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-56433802-1', 'auto');
          ga('send', 'pageview');
        </script>
        {% assets "js" %}<script type="text/javascript" src="{{ ASSET_URL }}"></script>{% endassets %}
    </body>
</html>